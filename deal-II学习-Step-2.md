---
title: deal.II学习--Step-2
date: 2019-12-11 10:32:05
tags:
- dealii
categories:
- dealii
---

# 简介

在 Step-1 中已经介绍了如何定义网格，在这个部分将会介绍如何在网格的基础上定义自由度。这个示例程序采用线性单元，即一阶单元（$Q_1$），单元中的自由度的数目与节点的数目相同。在之后的示例程序中还会展示如何定义高阶单元，在高阶单元中，自由度与边、面或体有关，与节点数目关联不大。



在有限元法中，自由度（degree of freedom）有两层意思：

* 在有限元法中，解可以表示为形函数的线性组合，即$u_h(x)=\sum^{N-1}_{j=0} U_j \phi_j(x)$。在此，$U_j$是展开系数向量，值未知。需要组成线性方程组进行求解，因此 它们被称为“未知量”或者“自由度”。
* 有限元法的数学解释为：寻求一个解空间$u_h \in V_h$，对所有的测试函数$\phi_h \in V_h$，满足方程$a(u_h,\phi_h)=(f,\phi_h)$。为了求解这个问题，我们需要选取空间$V_h$中的一组基，在有限元法中基要定义在网格与单元之上。从这个意义上理解，自由度即为基函数的空间$V_h$的度量。在deal.II中，类DoFHandler提供了自由度的相关功能。


在deal.II中，由于函数库已经完成了相关的实现，所以定义自由度是一件非常简单的事情。基本上，要做的事情首先是定义一个有限元类，然后通过DoFHandler::distribute_dofs函数来实现自由度的定义。DoFHandler可以解决与自由度有关的相关问题，如：“总体上有多少个自由度”，“局部单元中的下标在总体坐标系下下标是多少”。



## 稀疏性

在定义了自由度之后，便需要根据微分方程，计算相应的线性方程组，在Step-3中会讲解相应的过程。在此想要叙述的是有限元法中重要的一点：有限元法线性方程组中的矩阵是稀疏的，大多数系数为0 。



更为准确地说，稀疏矩阵每一行/列中非零项地个数是有上限的，这个上限是一个与总自由度无关的常数，一般与数值方法有关。比如求解拉普拉斯方程的5点差分法，用有限元求解，其矩阵每一行中非零项为5个。对于更加复杂的问题，如Step-22中的斯托克斯问题，每行中的非零项可以达到数百个。但是重点是这个数字与矩阵的大小无关：如果网格变得精细，每行中非零项的个数依然保持不变。










